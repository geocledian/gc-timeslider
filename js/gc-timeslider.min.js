"use strict";const gcTimesliderLocales={en:{options:{title:"Timeslider"},labels:{date:"Date",no_data:"Sorry, no data available!",images:"images",of:"of"}},de:{options:{title:"Zeitreihe"},labels:{date:"Datum",no_data:"Leider keine Daten verfügbar!",images:"Aufnahmen",of:"von"}},lt:{options:{title:"Laiko eilutės"},labels:{date:"Data",no_data:"Atsiprašome, duomenų nėra!",images:"Indeksų žemėlapis",of:"iš"}}};Vue.component("gc-timeslider",{props:{gcWidgetId:{type:String,default:"timeslider1",required:!0},gcTimeseries:{type:Array,default:function(){return[]}},gcSelectedDate:{type:String,default:""},gcAvailableOptions:{type:String,default:"widgetTitle,playButton,backwardForwardButton,dateLabel,numberOfimages"},gcWidgetCollapsed:{type:Boolean,default:!1},gcLanguage:{type:String,default:"en"},gcImageChangeInterval:{type:Number,default:1200}},template:'<div :id="this.gcWidgetId" class="">\n\n                <p :class="[\'gc-options-title\', \'is-size-6\', gcWidgetCollapsed ? \'is-grey\' : \'is-orange\']" \n                  style="cursor: pointer; margin-bottom: 0.5em;"    \n                  v-on:click="toggleTimeslider" \n                  v-show="availableOptions.includes(\'widgetTitle\')">\n                 {{ $t(\'options.title\')}}\n                  <i :class="[!gcWidgetCollapsed ? \'\': \'is-active\', \'fas\', \'fa-angle-down\', \'fa-sm\']"></i>\n                </p>\n\n                \x3c!-- timesilder container --\x3e\n                <div :class="[!gcWidgetCollapsed ? \'\': \'is-hidden\']" style="width: 100%; margin-bottom: 1em;">\n\n                  <div class="is-flex">\n                    <button :class="[isPlaying ? \'is-active\' : \'\', \'button\', \'is-light\', \'is-orange\']" \n                            v-on:click="startPauseVideo()" v-show="this.availableOptions.includes(\'playButton\')">\n                      <i class="fas fa-play" v-if="!this.isPlaying"></i>\n                      <i class="fas fa-pause" v-else></i>\n                    </button>\n                    <input type="range" class="slider is-small is-orange" min="0" :max="this.timeseries.length-1" value="0"\n                          style="width: 100%" v-model="currentTimeseriesIndex">\n                    <button class="button is-light is-orange" v-on:click="backwardTimeSeries()" \n                      v-show="this.availableOptions.includes(\'backwardForwardButton\')">\n                      <i class="fas fa-step-backward"></i>\n                    </button>\n                    <button class="button is-light is-orange" v-on:click="forwardTimeSeries()"\n                      v-show="this.availableOptions.includes(\'backwardForwardButton\')">\n                      <i class="fas fa-step-forward"></i>\n                    </button>\n                  </div>\n                  <div class="content is-normal is-orange has-text-centered" \n                        v-if="timeseries.length > 0 && getCurrentItem()">\n                    <div class="is-small has-text-centered" style="margin-top: 0.25em;"\n                      v-show="this.availableOptions.includes(\'dateLabel\')">\n                      <i class="fas fa-clock fa-lg"></i>\n                      {{ $t(\'labels.date\') }}: {{ getCurrentItem().date }} ({{getCurrentItem().source}})<span v-show="this.availableOptions.includes(\'numberOfimages\')">, #{{ (parseInt(currentTimeseriesIndex)+1)}} {{$t(\'labels.of\') }}  {{this.timeseries.length}} {{$t(\'labels.images\') }}</span>\n                    </div>\n                  </div>\n                  <div class="content is-normal is-orange has-text-centered" \n                    v-show="this.availableOptions.includes(\'dateLabel\')"\n                      v-else>\n                    <i class="fas fa-clock fa-lg"></i> {{ $t(\'labels.no_data\') }}\n                  </div>\n                </div> \x3c!-- timeslider container --\x3e\n\n            </div>\x3c!-- gcWidgetId --\x3e',data:function(){return console.debug("timeslider! - data()"),{currentTimeseriesIndex:-1,isPlaying:!1,myTimer:{},currentTimeSliderPosition:0}},i18n:{locale:this.currentLanguage,messages:gcTimesliderLocales},created:function(){console.debug("timeslider! - created()"),this.changeLanguage()},mounted:function(){console.debug("timeslider! - mounted()");try{this.changeLanguage()}catch(ex){}},computed:{timeseries:{get:function(){return console.debug("timeseries() getter"),this.gcTimeseries}},availableOptions:{get:function(){return this.gcAvailableOptions.split(",")}},currentLanguage:{get:function(){return this.gcLanguage}},selectedDate:{get:function(){return this.gcSelectedDate},set:function(value){console.debug("selectedDate - setter: "+value);let idx=this.timeseries.indexOf(this.timeseries.filter(t=>t.date==new Date(value).simpleDate())[0]);this.currentTimeseriesIndex=idx>=0?idx:this.timeseries.length-1,this.$root.$emit("queryDateChange",value)}}},watch:{gcTimeseries(newValue,oldValue){this.timeseries.length>0&&(this.selectedDate=this.timeseries[this.timeseries.length-1].date,this.currentTimeseriesIndex=this.timeseries.length-1)},currentLanguage(newValue,oldValue){this.changeLanguage()},gcSelectedDate(newValue,oldValue){console.debug("gcSelectedDateChange"),this.selectedDate=newValue},currentTimeseriesIndex(newValue,oldValue){let newDate;this.currentTimeseriesIndex>=0&&this.timeseries.length>0&&(newDate=this.timeseries[this.currentTimeseriesIndex].date,this.$root.$emit("queryDateChange",newDate))}},methods:{toggleTimeslider(){this.gcWidgetCollapsed=!this.gcWidgetCollapsed},getCurrentItem(){if(this.currentTimeseriesIndex>=0)return this.timeseries[this.currentTimeseriesIndex]},getCurrentIndex(){if(this.timeseries.length>0){let idx=this.timeseries.indexOf(this.timeseries.filter(t=>t.date==new Date(this.selectedDate).simpleDate())[0]);if(idx>=0)return idx}},changeLanguage(){this.$i18n.locale=this.currentLanguage},startPauseVideo(){if(console.log("startPauseVideo()"),this.isPlaying)this.isPlaying=!1,clearInterval(this.myTimer);else{this.isPlaying=!0;let timeSeriesCount=this.timeseries.length;clearInterval(this.myTimer),this.myTimer=setInterval(function(){this.currentTimeSliderPosition<=timeSeriesCount&&(this.currentTimeSliderPosition==timeSeriesCount&&(this.currentTimeSliderPosition=0),this.currentTimeseriesIndex=this.currentTimeSliderPosition+"",this.currentTimeSliderPosition++)}.bind(this),this.gcImageChangeInterval)}},forwardTimeSeries(){var j=parseInt(this.currentTimeseriesIndex);(j+=1)>=0&&j<this.timeseries.length&&(this.currentTimeseriesIndex=j+"")},backwardTimeSeries(){var j=parseInt(this.currentTimeseriesIndex);(j-=1)>=0&&j<this.timeseries.length&&(this.currentTimeseriesIndex=j+"")},formatDecimal(decimal,numberOfDecimals){var factor=100;return isNaN(parseFloat(decimal))?NaN:(1==numberOfDecimals&&(factor=10),2==numberOfDecimals&&(factor=100),3==numberOfDecimals&&(factor=1e3),4==numberOfDecimals&&(factor=1e4),5==numberOfDecimals&&(factor=1e5),Math.ceil(decimal*factor)/factor)}}});